<pages:BasePage x:Class="Heimatplatz.Features.Properties.Presentation.FilterPreferencesPage"
      x:Name="RootPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:Heimatplatz.Features.Properties.Presentation"
      xmlns:controls="using:Heimatplatz.Features.Properties.Controls"
      xmlns:utu="using:Uno.Toolkit.UI"
      xmlns:uc="using:UnoFramework.Controls"
      xmlns:pages="using:UnoFramework.Pages"
      NavigationCacheMode="Disabled"
      Background="{ThemeResource BackgroundBrush}">

    <!--
    FilterPreferencesPage - Filtereinstellungen fuer eingeloggte Benutzer
    Ermoeglicht das Vorkonfigurieren von Standardfiltern (Ort, Zeit, Typ)
    -->

    <Grid>
        <uc:BusyOverlay IsBusy="{Binding IsBusy}"
                        BusyMessage="Laden..."
                        AutomationProperties.AutomationId="FilterPreferences_BusyOverlay">

            <ScrollViewer>
                <utu:AutoLayout Padding="24"
                                Spacing="24"
                                Orientation="Vertical"
                                MaxWidth="600"
                                HorizontalAlignment="Center"
                                utu:SafeArea.Insets="Bottom">

                    <!-- Description with auto-save indicator -->
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0"
                                   Text="Konfigurieren Sie Ihre Standard-Filtereinstellungen. Aenderungen werden automatisch gespeichert."
                                   Style="{StaticResource BodyTextBlockStyle}"
                                   Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                   TextWrapping="Wrap"
                                   AutomationProperties.AutomationId="FilterPreferences_Description" />

                        <StackPanel Grid.Column="1"
                                    Orientation="Horizontal"
                                    Spacing="6"
                                    VerticalAlignment="Center"
                                    Visibility="{Binding IsSaving}"
                                    AutomationProperties.AutomationId="FilterPreferences_SavingIndicator">
                            <ProgressRing IsActive="{Binding IsSaving}"
                                          Width="16"
                                          Height="16" />
                            <TextBlock Text="Speichern..."
                                       Style="{StaticResource CaptionTextBlockStyle}"
                                       Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </Grid>

                    <!-- Ort-Filter Card -->
                    <utu:CardContentControl Style="{StaticResource FilledCardContentControlStyle}"
                                            AutomationProperties.AutomationId="FilterPreferences_OrtCard">
                        <utu:AutoLayout Padding="16" Spacing="16" Orientation="Vertical">
                            <utu:AutoLayout Spacing="4" Orientation="Vertical">
                                <TextBlock Text="Orte"
                                           Style="{StaticResource SubtitleTextBlockStyle}" />
                                <TextBlock Text="Waehlen Sie die Orte aus, die standardmaessig gefiltert werden sollen."
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                           TextWrapping="Wrap" />
                            </utu:AutoLayout>

                            <controls:OrtPicker Bezirke="{Binding Bezirke}"
                                                SelectedOrte="{Binding SelectedOrte, Mode=TwoWay}"
                                                HorizontalAlignment="Stretch"
                                                AutomationProperties.AutomationId="FilterPreferences_OrtPicker" />
                        </utu:AutoLayout>
                    </utu:CardContentControl>

                    <!-- Zeitraum-Filter Card -->
                    <utu:CardContentControl Style="{StaticResource FilledCardContentControlStyle}"
                                            AutomationProperties.AutomationId="FilterPreferences_AgeCard">
                        <utu:AutoLayout Padding="16" Spacing="16" Orientation="Vertical">
                            <utu:AutoLayout Spacing="4" Orientation="Vertical">
                                <TextBlock Text="Zeitraum"
                                           Style="{StaticResource SubtitleTextBlockStyle}" />
                                <TextBlock Text="Waehlen Sie den Standard-Zeitraum fuer die Anzeige von Immobilien."
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                           TextWrapping="Wrap" />
                            </utu:AutoLayout>

                            <controls:AgeFilterPicker SelectedAgeFilter="{Binding SelectedAgeFilter, Mode=TwoWay}"
                                                      HorizontalAlignment="Stretch"
                                                      AutomationProperties.AutomationId="FilterPreferences_AgeFilterPicker" />
                        </utu:AutoLayout>
                    </utu:CardContentControl>

                    <!-- Immobilientyp-Filter Card -->
                    <utu:CardContentControl Style="{StaticResource FilledCardContentControlStyle}"
                                            AutomationProperties.AutomationId="FilterPreferences_TypeCard">
                        <utu:AutoLayout Padding="16" Spacing="16" Orientation="Vertical">
                            <utu:AutoLayout Spacing="4" Orientation="Vertical">
                                <TextBlock Text="Immobilientyp"
                                           Style="{StaticResource SubtitleTextBlockStyle}" />
                                <TextBlock Text="Waehlen Sie die Immobilientypen, die standardmaessig angezeigt werden sollen."
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                           TextWrapping="Wrap" />
                            </utu:AutoLayout>

                            <StackPanel Orientation="Horizontal"
                                        Spacing="8"
                                        AutomationProperties.AutomationId="FilterPreferences_FilterChips">
                                <controls:FilterChip Label="Haus"
                                                     IsSelected="{Binding IsHausSelected, Mode=TwoWay}"
                                                     AutomationProperties.AutomationId="FilterPreferences_Chip_Haus" />
                                <controls:FilterChip Label="Grund"
                                                     IsSelected="{Binding IsGrundstueckSelected, Mode=TwoWay}"
                                                     AutomationProperties.AutomationId="FilterPreferences_Chip_Grund" />
                                <controls:FilterChip Label="ZV"
                                                     IsSelected="{Binding IsZwangsversteigerungSelected, Mode=TwoWay}"
                                                     AutomationProperties.AutomationId="FilterPreferences_Chip_ZV" />
                            </StackPanel>
                        </utu:AutoLayout>
                    </utu:CardContentControl>

                    <!-- Anbietertyp-Filter Card -->
                    <utu:CardContentControl Style="{StaticResource FilledCardContentControlStyle}"
                                            AutomationProperties.AutomationId="FilterPreferences_SellerTypeCard">
                        <utu:AutoLayout Padding="16" Spacing="16" Orientation="Vertical">
                            <utu:AutoLayout Spacing="4" Orientation="Vertical">
                                <TextBlock Text="Anbietertyp"
                                           Style="{StaticResource SubtitleTextBlockStyle}" />
                                <TextBlock Text="Waehlen Sie die Anbietertypen, die standardmaessig angezeigt werden sollen."
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                           TextWrapping="Wrap" />
                            </utu:AutoLayout>

                            <controls:SellerTypePicker SellerTypes="{Binding SellerTypes}"
                                                       HorizontalAlignment="Stretch"
                                                       AutomationProperties.AutomationId="FilterPreferences_SellerTypePicker" />
                        </utu:AutoLayout>
                    </utu:CardContentControl>

                    <!-- Error Message -->
                    <Border Background="{ThemeResource ErrorBackgroundBrush}"
                            CornerRadius="8"
                            Padding="16"
                            Visibility="{Binding ShowErrorMessage}"
                            AutomationProperties.AutomationId="FilterPreferences_ErrorMessage">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE783;"
                                      FontSize="20"
                                      Foreground="{ThemeResource ErrorForegroundBrush}" />
                            <TextBlock Text="{Binding ErrorMessage}"
                                       Foreground="{ThemeResource ErrorForegroundBrush}"
                                       VerticalAlignment="Center"
                                       TextWrapping="Wrap" />
                        </StackPanel>
                    </Border>

                    <!-- Info Card -->
                    <Border Background="{ThemeResource SurfaceVariantBrush}"
                            CornerRadius="8"
                            Padding="16"
                            AutomationProperties.AutomationId="FilterPreferences_InfoCard">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE946;"
                                      FontSize="20"
                                      Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                      VerticalAlignment="Top" />
                            <TextBlock Text="Ihre Einstellungen werden automatisch gespeichert und beim naechsten Besuch der Startseite angewendet."
                                       Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                       TextWrapping="Wrap"
                                       Style="{StaticResource CaptionTextBlockStyle}" />
                        </StackPanel>
                    </Border>

                </utu:AutoLayout>
            </ScrollViewer>
        </uc:BusyOverlay>
    </Grid>
</pages:BasePage>
