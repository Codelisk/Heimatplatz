<Page x:Class="Heimatplatz.Features.Properties.Presentation.FilterPreferencesPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:Heimatplatz.Features.Properties.Presentation"
      xmlns:controls="using:Heimatplatz.Features.Properties.Controls"
      xmlns:utu="using:Uno.Toolkit.UI"
      xmlns:uc="using:UnoFramework.Controls"
      Background="{ThemeResource BackgroundBrush}">

    <!--
    FilterPreferencesPage - Filtereinstellungen fuer eingeloggte Benutzer
    Ermoeglicht das Vorkonfigurieren von Standardfiltern (Ort, Zeit, Typ)
    -->

    <Grid>
        <uc:BusyOverlay IsBusy="{Binding IsBusy}"
                        BusyMessage="Laden..."
                        AutomationProperties.AutomationId="FilterPreferences_BusyOverlay">

            <ScrollViewer>
                <utu:AutoLayout Padding="24"
                                Spacing="24"
                                Orientation="Vertical"
                                MaxWidth="600"
                                HorizontalAlignment="Center"
                                utu:SafeArea.Insets="Bottom">

                    <!-- Header -->
                    <utu:AutoLayout Spacing="8" Orientation="Vertical">
                        <TextBlock Text="Filtereinstellungen"
                                   Style="{StaticResource TitleTextBlockStyle}"
                                   AutomationProperties.AutomationId="FilterPreferences_Title" />
                        <TextBlock Text="Konfigurieren Sie Ihre Standard-Filtereinstellungen. Diese werden automatisch angewendet, wenn Sie die Startseite besuchen."
                                   Style="{StaticResource BodyTextBlockStyle}"
                                   Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                   TextWrapping="Wrap"
                                   AutomationProperties.AutomationId="FilterPreferences_Description" />
                    </utu:AutoLayout>

                    <!-- Ort-Filter Card -->
                    <utu:Card AutomationProperties.AutomationId="FilterPreferences_OrtCard">
                        <utu:AutoLayout Padding="16" Spacing="16" Orientation="Vertical">
                            <utu:AutoLayout Spacing="4" Orientation="Vertical">
                                <TextBlock Text="Orte"
                                           Style="{StaticResource SubtitleTextBlockStyle}" />
                                <TextBlock Text="Waehlen Sie die Orte aus, die standardmaessig gefiltert werden sollen."
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                           TextWrapping="Wrap" />
                            </utu:AutoLayout>

                            <controls:OrtPicker Bezirke="{Binding Bezirke}"
                                                SelectedOrte="{Binding SelectedOrte, Mode=TwoWay}"
                                                HorizontalAlignment="Stretch"
                                                AutomationProperties.AutomationId="FilterPreferences_OrtPicker" />
                        </utu:AutoLayout>
                    </utu:Card>

                    <!-- Zeitraum-Filter Card -->
                    <utu:Card AutomationProperties.AutomationId="FilterPreferences_AgeCard">
                        <utu:AutoLayout Padding="16" Spacing="16" Orientation="Vertical">
                            <utu:AutoLayout Spacing="4" Orientation="Vertical">
                                <TextBlock Text="Zeitraum"
                                           Style="{StaticResource SubtitleTextBlockStyle}" />
                                <TextBlock Text="Waehlen Sie den Standard-Zeitraum fuer die Anzeige von Immobilien."
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                           TextWrapping="Wrap" />
                            </utu:AutoLayout>

                            <controls:AgeFilterPicker SelectedAgeFilter="{Binding SelectedAgeFilter, Mode=TwoWay}"
                                                      HorizontalAlignment="Stretch"
                                                      AutomationProperties.AutomationId="FilterPreferences_AgeFilterPicker" />
                        </utu:AutoLayout>
                    </utu:Card>

                    <!-- Immobilientyp-Filter Card -->
                    <utu:Card AutomationProperties.AutomationId="FilterPreferences_TypeCard">
                        <utu:AutoLayout Padding="16" Spacing="16" Orientation="Vertical">
                            <utu:AutoLayout Spacing="4" Orientation="Vertical">
                                <TextBlock Text="Immobilientyp"
                                           Style="{StaticResource SubtitleTextBlockStyle}" />
                                <TextBlock Text="Waehlen Sie die Immobilientypen, die standardmaessig angezeigt werden sollen."
                                           Style="{StaticResource CaptionTextBlockStyle}"
                                           Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                           TextWrapping="Wrap" />
                            </utu:AutoLayout>

                            <StackPanel Orientation="Horizontal"
                                        Spacing="8"
                                        AutomationProperties.AutomationId="FilterPreferences_FilterChips">
                                <controls:FilterChip Label="Alle"
                                                     IsSelected="{Binding IsAllSelected, Mode=TwoWay}"
                                                     AutomationProperties.AutomationId="FilterPreferences_Chip_All" />
                                <controls:FilterChip Label="Haus"
                                                     IsSelected="{Binding IsHausSelected, Mode=TwoWay}"
                                                     AutomationProperties.AutomationId="FilterPreferences_Chip_Haus" />
                                <controls:FilterChip Label="Grund"
                                                     IsSelected="{Binding IsGrundstueckSelected, Mode=TwoWay}"
                                                     AutomationProperties.AutomationId="FilterPreferences_Chip_Grund" />
                                <controls:FilterChip Label="ZV"
                                                     IsSelected="{Binding IsZwangsversteigerungSelected, Mode=TwoWay}"
                                                     AutomationProperties.AutomationId="FilterPreferences_Chip_ZV" />
                            </StackPanel>
                        </utu:AutoLayout>
                    </utu:Card>

                    <!-- Success Message -->
                    <Border Background="{ThemeResource SuccessBackgroundBrush}"
                            CornerRadius="8"
                            Padding="16"
                            Visibility="{Binding ShowSuccessMessage}"
                            AutomationProperties.AutomationId="FilterPreferences_SuccessMessage">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE73E;"
                                      FontSize="20"
                                      Foreground="{ThemeResource SuccessForegroundBrush}" />
                            <TextBlock Text="Einstellungen wurden gespeichert."
                                       Foreground="{ThemeResource SuccessForegroundBrush}"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </Border>

                    <!-- Error Message -->
                    <Border Background="{ThemeResource ErrorBackgroundBrush}"
                            CornerRadius="8"
                            Padding="16"
                            Visibility="{Binding ShowErrorMessage}"
                            AutomationProperties.AutomationId="FilterPreferences_ErrorMessage">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE783;"
                                      FontSize="20"
                                      Foreground="{ThemeResource ErrorForegroundBrush}" />
                            <TextBlock Text="{Binding ErrorMessage}"
                                       Foreground="{ThemeResource ErrorForegroundBrush}"
                                       VerticalAlignment="Center"
                                       TextWrapping="Wrap" />
                        </StackPanel>
                    </Border>

                    <!-- Save Button -->
                    <Button Command="{Binding SavePreferencesCommand}"
                            HorizontalAlignment="Stretch"
                            Background="{ThemeResource PrimaryButtonBackgroundBrush}"
                            Foreground="{ThemeResource PrimaryButtonForegroundBrush}"
                            FontWeight="SemiBold"
                            Padding="16,12"
                            CornerRadius="{StaticResource RadiusSm}"
                            AutomationProperties.AutomationId="FilterPreferences_SaveButton">
                        <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                            <ProgressRing IsActive="{Binding IsSaving}"
                                          Width="16"
                                          Height="16"
                                          Visibility="{Binding IsSaving}"
                                          Foreground="{ThemeResource PrimaryButtonForegroundBrush}" />
                            <TextBlock Text="Einstellungen speichern"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>

                    <!-- Info Card -->
                    <Border Background="{ThemeResource SurfaceVariantBrush}"
                            CornerRadius="8"
                            Padding="16"
                            AutomationProperties.AutomationId="FilterPreferences_InfoCard">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE946;"
                                      FontSize="20"
                                      Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                      VerticalAlignment="Top" />
                            <TextBlock Text="Diese Einstellungen werden auf Ihrem Geraet gespeichert und automatisch angewendet, wenn Sie die Startseite besuchen."
                                       Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                       TextWrapping="Wrap"
                                       Style="{StaticResource CaptionTextBlockStyle}" />
                        </StackPanel>
                    </Border>

                </utu:AutoLayout>
            </ScrollViewer>
        </uc:BusyOverlay>
    </Grid>
</Page>
